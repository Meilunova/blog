
---

### **CLI 工具使用文档 (`add-music.js` & `add-favorite.js`)**

#### **1. 简介**

本工具集包含两个独立的命令行脚本，用于管理您网站的“音乐分享”和“收藏夹”数据。它们提供了统一的交互式界面，让您无需手动编辑复杂的 `js` 文件。

-   `add-music.js`: 管理 `source/js/music-share-data.js` 文件。
-   `add-favorite.js`: 管理 `source/js/favorites-data-complete.js` 文件。

#### **2. 如何运行**

在您的项目根目录下，使用 Node.js 运行相应的脚本：

```bash
# 管理音乐数据
node add-music.js

# 管理收藏夹数据
node add-favorite.js
```

运行后，您将看到一个功能菜单，根据提示输入序号即可执行相应操作。

#### **3. 功能详解**

两个脚本的功能和操作流程基本一致，区别仅在于管理的数据对象不同（音乐 vs. 收藏）。

##### **3.1 添加 (`Add`)**

-   **用途**：逐条添加新的音乐或收藏条目。
-   **流程**：
    1.  选择一个主分类和一个子分类作为目标位置。
    2.  如果需要，您可以创建新的主分类或子分类。
    3.  根据提示，依次填写条目的各项信息（如标题、网址、标签等）。必填项不能为空。
    4.  确认无误后，条目将被添加到指定分类。
    5.  您可以选择在当前分类下继续添加，或返回主菜单。

##### **3.2 删除 (`Delete`)**

-   **用途**：移除一个或多个条目。
-   **提供两种模式**：
    1.  **按分类浏览删除**：逐级进入分类，脚本会列出该分类下的所有条目。您可以输入序号（支持多个，用逗号分隔）或 `a`（全选）来指定要删除的条目。
    2.  **按关键字搜索删除**：输入关键字，脚本会搜索所有条目的名称、描述、标签等字段。在搜索结果中，同样可以通过输入序号来指定删除对象。

##### **3.3 编辑 (`Edit`)**

-   **用途**：修改已有条目的信息。
-   **提供两种模式**：
    1.  **按分类浏览编辑**：与删除类似，逐级进入分类找到要编辑的条目。
    2.  **按关键字搜索编辑**：通过关键字快速定位到要编辑的条目。
-   **流程**：
    1.  定位到目标条目后，脚本会逐一显示该条目的当前信息。
    2.  您可以输入新内容来修改，或直接按回车键保留当前值。

##### **3.4 移动 (`Move`)**

-   **用途**：将一个或多个条目从一个分类移动到另一个分类。
-   **流程**：
    1.  **选择来源**：您可以通过“按分类浏览”或“按关键字搜索”来选择一个或多个要移动的条目。
    2.  **选择目标**：选择一个目标分类（如果需要，也可以新建分类）。
    3.  确认后，所选条目将从原位置移除，并添加到新位置。

##### **3.5 清理 (`Clean`)**

-   **用途**：移除数据中所有“完全为空”的分类和子分类。
-   **流程**：
    1.  脚本会自动扫描并删除所有不包含任何条目和子分类的空节点。
    2.  在清理后，您可以选择是否要一并删除那些自身已变为空的主分类。

##### **3.6 批量导入 (`Batch Import`)**

-   **用途**：从 `CSV` 或 `JSON` 文件一次性导入大量数据。
-   **流程**：
    1.  提供 `CSV` 或 `JSON` 文件的本地路径。
    2.  选择一个目标分类用于存放导入的数据。
    3.  **选择去重策略**：这是为了防止重复导入。
        -   **音乐 (`add-music.js`)**：可按“`title`+`artist`+`album`”、“`retrievalCode`”或“`shareLink`”去重。
        -   **收藏 (`add-favorite.js`)**：可按“`URL`”或“`name`+`description`”去重。
        -   脚本会自动跳过那些根据策略判断已存在于目标分类中的条目。
    4.  确认后，所有不重复的有效条目将被导入。

#### **4. 批量导入文件格式**

##### **JSON 格式**

文件内容应该是一个 **JSON 数组**，数组中的每个对象代表一个条目。

-   **`add-music.js` 示例**：
    ```json
    [
      {
        "title": "歌曲名",
        "artist": "艺人名",
        "album": "专辑名",
        "retrievalCode": "提取码",
        "shareLink": "http://example.com/share",
        "tags": "标签1 标签2",
        "cover": "http://example.com/cover.jpg",
        "description": "可选描述",
        "previewLink": "http://example.com/preview.mp3"
      }
    ]
    ```

-   **`add-favorite.js` 示例**：
    ```json
    [
      {
        "name": "网站名",
        "url": "http://example.com",
        "description": "网站描述",
        "tags": "标签1 标签2",
        "icon": "图标URL或Emoji"
      }
    ]
    ```

##### **CSV 格式**

-   第一行必须是 **表头**，用于标识每一列的数据类型。
-   列的顺序不重要，但 **必须包含所有必填字段** 的表头。
-   **`add-music.js` 必填表头**：`title`, `artist`, `album`, `retrievalCode`, `shareLink`, `tags`。
-   **`add-favorite.js` 必填表头**：`name`, `url`, `description`, `tags`。
-   可选字段（如 `cover`, `icon`）如果存在对应表头，也会被导入。

---
